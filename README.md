# 图片比较器

一个基于多种哈希算法的图片相似度比较工具，可以帮助用户找出相似的图片并进行管理。

## 功能特点

- **多算法融合**：使用感知哈希(PHash)、平均哈希(AHash)和差异哈希(DHash)三种算法综合计算图片相似度，提高识别准确率。
- **批量处理**：支持选择多个文件夹进行批量处理。
- **智能分组**：自动将相似的图片分组显示，便于比较和管理。
- **最佳图片识别**：自动识别每组中的最佳图片（基于文件大小和分辨率）。
- **便捷删除**：点击图片即可删除，悬停时显示红色边框提示。
- **自动清理**：支持自动删除每组中非最佳的图片，保留最佳图片。

## 安装说明

1. 确保已安装Python 3.6或更高版本。
2. 安装所需的依赖包：

```bash
pip install flask pillow imagehash numpy opencv-python
```

## 使用方法

1. 运行程序：

```bash
python app.py
```

2. 程序会自动打开浏览器，访问 http://127.0.0.1:18200

3. 在网页界面中：
   - 点击"选择文件夹"按钮，选择包含图片的文件夹（可以多次点击选择多个文件夹）。
   - 调整相似度阈值（建议70-90）和哈希大小（建议8）。
   - 点击"处理图片"按钮，程序会分析图片并找出相似的图片组。
   - 查看相似图片组，每组中的最佳图片会有绿色边框和"最佳"标记。
   - 点击图片即可删除（悬停时会显示红色边框和"点击删除"提示）。
   - 也可以选择多个组，然后点击"自动删除"按钮，系统会保留每组中的最佳图片，删除其他图片（需要确认）。

## 算法原理

本工具使用三种哈希算法计算图片相似度：

1. **感知哈希(PHash)**：基于图片的频率特征，对图片的缩放、压缩和颜色变化有较好的鲁棒性。
2. **平均哈希(AHash)**：基于图片的平均灰度值，计算简单快速。
3. **差异哈希(DHash)**：基于相邻像素的差异，对图片的细节变化敏感。

最终相似度是三种算法的加权平均（PHash 50%，AHash 30%，DHash 20%），综合了各种算法的优点。

## 最佳图片识别

每组中的最佳图片是通过以下标准确定的：
- 文件大小（权重30%）
- 图片分辨率（权重70%）

系统会计算每张图片的综合得分，选择得分最高的图片作为最佳图片。

## 注意事项

- 首次处理大量图片可能需要较长时间，请耐心等待。
- 删除操作不可撤销，请谨慎操作。
- 自动删除功能会删除每组中除最佳图片外的所有图片，请确认后再执行。

## 技术栈

- 后端：Python, Flask, PIL, imagehash
- 前端：HTML, CSS, JavaScript

## 许可证

本项目采用MIT许可证。

---

ELLRA蓝电

## 开发原因

其实是因为找不到好用的免费识别软件 才制作的awa

## 🔥 重大更新：v2.0 - 从 Web 应用到原生桌面 GUI

为了提供更稳定、更流畅的用户体验，并彻底解决跨平台打包的复杂性问题，本项目已经从基于 Flask 的 Web 应用架构，**完全重构为一个使用 PyQt6 的原生桌面应用程序**。

这是一个里程碑式的版本，带来了以下核心变更：

### 核心架构变更

| 旧版 (v1.x) | **新版 (v2.0)** | 优势 |
| :--- | :--- | :--- |
| 后端: Python, Flask | **后端: Python (无Web框架)** | 移除了复杂的网络依赖，打包更可靠。 |
| 前端: HTML, CSS, JS | **前端: PyQt6 (原生GUI)** | 响应速度更快，体验更接近原生软件。 |
| 通信: WebSockets | **通信: PyQt Signals & Slots** | 内部信号通信，更稳定，无网络延迟。 |
| 运行方式: `python app.py` + 浏览器 | **运行方式: 双击 `.exe` 文件** | 无需浏览器，单个文件即可运行，更易分发。 |

### 主要功能与性能优化

- **原生UI界面**：所有操作都在一个独立的桌面窗口中完成，不再依赖浏览器。
- **多线程性能飞跃**：重写了核心处理逻辑，现在会充分利用多核心CPU**并行计算**图片的哈希值和相似度，处理大量图片时的速度得到**显著提升**。
- **更精细的控制**：
    - **哈希大小不受限**：您可以自由输入任意整数作为哈希大小，以进行更精细的比较。
    - **行级滚动条**：当一组相似图片过多时，可以方便地横向滚动浏览。
- **增强的用户体验**：
    - **实时进度反馈**：进度条和状态文本现在能更精确地显示当前的处理阶段和进度（例如 `阶段 2/3: 比较中... (1234/5000)`）。
    - **全新的视觉风格**：采纳了更清新、更现代的扁平化UI设计。

### 更新后的安装与使用

#### 安装依赖

```bash
# (在一个虚拟环境中)
pip install PyQt6 Pillow imagehash numpy pyinstaller
```

#### 使用方法

1.  直接下载并运行 `ImageComparator.exe` 文件 (位于 [Releases](https://github.com/MC180180/Visualization-of-data-entropy/releases) 页面)。
2.  或者，从源代码运行：
    ```bash
    python gui_app.py
    ```
3.  在程序窗口中选择文件夹、调整参数并开始处理。所有操作均在程序内完成。

---
*原有的 `README.md` 内容可以保留在下方，作为对项目历史和算法原理的介绍。*
